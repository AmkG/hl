; tests for literal values

(using <simple-test>v0)
(using <bc>v0) ; to avoid prepending <bc> to every bytecode

(test "Integers"
  0 ((check-vars 2)
     (int 0)
     (continue))
  -1 ((check-vars 2)
      (int -1)
      (continue))
  42 ((check-vars 2)
      (int 42)
      (continue))
  1073741823 ((check-vars 2)
              (int 1073741823)
              (continue)))

(test "Characters"
  #\a ((check-vars 2)
       (char 97)
       (continue))
  #\newline ((check-vars 2)
             (char 10)
             (continue))
  #\space ((check-vars 2)
           (char 32)
           (continue))
  ; TODO: add unicode characters
  )

(test "t & nil"
  t ((check-vars 2)
     (lit-t)
     (continue))
  't ((check-vars 2)
     (lit-t)
     (continue))
  nil ((check-vars 2)
       (lit-nil)
       (continue))
  'nil ((check-vars 2)
        (lit-nil)
        (continue))
  () ((check-vars 2)
      (lit-nil)
      (continue))
  '() ((check-vars 2)
       (lit-nil)
       (continue)))

(test "list"
  '(1) ((check-vars 2)
        (int 1)
        (lit-nil)
        (cons)
        (continue-local 3))
  '(1 . 2) ((check-vars 2)
            (int 1)
            (int 2)
            (cons)
            (continue-local 3))
  '(1 2 3) ((check-vars 2)
            (int 1)
            (int 2)
            (int 3)
            (lit-nil)
            (cons)
            (cons)
            (cons)
            (continue-local 3)))
